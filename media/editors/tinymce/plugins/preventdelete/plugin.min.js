tinymce.PluginManager.add("preventdelete",function(e,t){var o,n=!1,a=["imatge-noticia","ioc-news","ioc-news-content","more-section","more-section-content","nav-tabs","panel-title","tab-pane","study-definition","study-tabs","study-date","study-days","study-month","semiheader","panel-heading","panel-title-anchor","col-sm-2","col-sm-4","col-sm-8","col-sm-10"],l=function(e){var t,o=0,n=e.ownerDocument||e.document,a=n.defaultView||n.parentWindow;if(void 0!==a.getSelection){if((t=a.getSelection()).rangeCount>0){var l=a.getSelection().getRangeAt(0),d=l.cloneRange();d.selectNodeContents(e),d.setEnd(l.endContainer,l.endOffset),o=d.toString().length}}else if((t=n.selection)&&"Control"!=t.type){var r=t.createRange(),i=n.body.createTextRange();i.moveToElementText(e),i.setEndPoint("EndToEnd",r),o=i.text.length}return o};e.on("keydown",function(t){var d=e.selection.getRng(),r=d.endContainer.parentElement,i=r.className,s=r.parentElement||r,p=s.className,c=l(r);if(console.log("startOffset "+c),8==t.keyCode||46==t.keyCode){if(o=window.getComputedStyle(s),"DIV"!=s.tagName||"dashed"!=o.getPropertyValue("border-top-style"))for(;s&&"HTML"!=s.tagName&&("DIV"!=s.tagName||"dashed"!=o.getPropertyValue("border-top-style"));)s=s.parentElement,o=window.getComputedStyle(s);if(!s||"DIV"!=s.tagName)return void console.log("No parent div");if(console.log(s.tagName),o=window.getComputedStyle(s),n="dashed"==o.getPropertyValue("border-top-style"),46==t.keyCode){if(c==r.textContent.length&&d.collapsed&&(s.childNodes[s.childNodes.length-1]===r||n))return console.log("Spr avoided"),t.preventDefault(),t.stopPropagation(),!1;if(o=window.getComputedStyle(s),n="dashed"==o.getPropertyValue("border-top-style"),c==r.textContent.length&&d.collapsed&&"LI"==r.parentElement.tagName&&n)return console.log("Spr avoided on tabs"),t.preventDefault(),t.stopPropagation(),!1}if(8==t.keyCode){if(o=window.getComputedStyle(s),n="dashed"==o.getPropertyValue("border-top-style"),console.log("TABS "+s.tagName),"0"==c&&n)return console.log("Backspace avoided"),t.preventDefault(),t.stopPropagation(),!1;if(o=window.getComputedStyle(r),n="dashed"==o.getPropertyValue("border-top-style"),i.indexOf(" ")>-1)i=i.split(" "),"0"==c&&i.forEach(function(e){if(n||a.indexOf(e)>-1)return console.log("Backspace avoided - First level multiple class"),t.preventDefault(),t.stopPropagation(),!1});else if("0"==c&&(n||a.indexOf(i)>-1))return console.log("Backspace avoided - First level single class"),t.preventDefault(),t.stopPropagation(),!1;if(o=window.getComputedStyle(s),n="dashed"==o.getPropertyValue("border-top-style"),p.indexOf(" ")>-1)p=p.split(" "),"0"==c&&s.childNodes[0]===r&&p.forEach(function(e){if(n||a.indexOf(e)>-1)return console.log("Backspace avoided - Second level multiple class"),t.preventDefault(),t.stopPropagation(),!1});else if("0"==c&&s.childNodes[0]===r&&(n||a.indexOf(p)>-1))return console.log("Backspace avoided - Second level single class"),t.preventDefault(),t.stopPropagation(),!1}}})});