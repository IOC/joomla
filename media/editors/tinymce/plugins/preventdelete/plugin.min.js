tinymce.PluginManager.add("preventdelete",function(e,t){var o,n=!1,a=["imatge-noticia","ioc-news","ioc-news-content","more-section","more-section-content","nav-tabs","panel-title","tab-pane","study-frame","study-term","study-definition","study-tabs","study-registration","study-date","semiheader","col-sm-2","col-sm-4","col-sm-8","col-sm-10"],l=function(e){var t,o=0,n=e.ownerDocument||e.document,a=n.defaultView||n.parentWindow;if(void 0!==a.getSelection){if(t=a.getSelection(),t.rangeCount>0){var l=a.getSelection().getRangeAt(0),r=l.cloneRange();r.selectNodeContents(e),r.setEnd(l.endContainer,l.endOffset),o=r.toString().length}}else if((t=n.selection)&&"Control"!=t.type){var d=t.createRange(),i=n.body.createTextRange();i.moveToElementText(e),i.setEndPoint("EndToEnd",d),o=i.text.length}return o};e.on("keydown",function(t){var r=e.selection.getRng(),d=r.endContainer.parentElement,i=d.className,s=d.parentElement,c=s.className,p=l(d);if(console.log("startOffset "+p),8==t.keyCode||46==t.keyCode){if("DIV"!=s.tagName)for(;s&&"DIV"!=s.tagName;)s=s.parentElement;if(!s||"DIV"!=s.tagName)return void console.log("No parent div");if(console.log(s.tagName),o=window.getComputedStyle(s),n="dashed"==o.getPropertyValue("border-top-style"),46==t.keyCode){if(p==d.textContent.length&&r.collapsed&&(s.childNodes[s.childNodes.length-1]===d||n))return console.log("Spr avoided"),t.preventDefault(),t.stopPropagation(),!1;if(o=window.getComputedStyle(d.parentElement),n="dashed"==o.getPropertyValue("border-top-style"),p==d.textContent.length&&r.collapsed&&"LI"==d.parentElement.tagName&&n)return console.log("Spr avoided on tabs"),t.preventDefault(),t.stopPropagation(),!1}if(8==t.keyCode){if(o=window.getComputedStyle(d.parentElement),n="dashed"==o.getPropertyValue("border-top-style"),console.log("TABS "+d.parentElement.tagName),"0"==p&&"LI"==d.parentElement.tagName&&n)return console.log("Backspace avoided on tabs"),t.preventDefault(),t.stopPropagation(),!1;if(o=window.getComputedStyle(d),n="dashed"==o.getPropertyValue("border-top-style"),i.indexOf(" ")>-1)i=i.split(" "),"0"==p&&i.forEach(function(e){if(n||a.indexOf(e)>-1)return console.log("Backspace avoided - First level multiple class"),t.preventDefault(),t.stopPropagation(),!1});else if("0"==p&&(n||a.indexOf(i)>-1))return console.log("Backspace avoided - First level single class"),t.preventDefault(),t.stopPropagation(),!1;if(o=window.getComputedStyle(s),n="dashed"==o.getPropertyValue("border-top-style"),c.indexOf(" ")>-1)c=c.split(" "),"0"==p&&s.childNodes[0]===d&&c.forEach(function(e){if(n||a.indexOf(e)>-1)return console.log("Backspace avoided - Second level multiple class"),t.preventDefault(),t.stopPropagation(),!1});else if("0"==p&&s.childNodes[0]===d&&(n||a.indexOf(c)>-1))return console.log("Backspace avoided - Second level single class"),t.preventDefault(),t.stopPropagation(),!1}}})});