tinymce.PluginManager.add("manageelements",function(e,E){var t,S,T,A,L,a,C,n,s,_,N,l={TAGS:{A:"A",UL:"UL",LI:"LI",DIV:"DIV",P:"P",IMG:"IMG"},SELECTORS:{CLASS_TAB_NODE:"nav-tabs",CLASS_TAB_CONTENT:"tab-content",CLASS_TAB_PANE:"tab-pane",CLASS_TAB_TITLE:"tab-title",CLASS_TITLE_MORE_INFO:"accordion-toggle",ID_MORE_INFO:"panel-sections",CLASS_PANEL_CONTENT:"panel-collapse",CLASS_PANEL_NODE:"panel",CLASS_PANEL_TITLE:"panel-title",CLASS_PANEL_BODY:"panel-body",CLASS_PANEL_HEADING:"panel-heading",CLASS_PANEL_RESOURCES:"panel-modal-resources",CLASS_INSERT_LINK:"mce-i-link",CLASS_STUDY_DATES:"study-dates",CLASS_STUDY_BLOCK:"study-block",CLASS_STUDY_BUTTON:"icon-text",CLASS_STUDY_DATE:"study-date",CLASS_SEMIHEADER:"semiheader",CLASS_MODAL:"modal",CLASS_MODAL_BODY:"body-modal-resources",CLASS_MODAL_BOTTOM:"bottom-modal-resource",CLASS_MODAL_CONTENT:"body-modal-content",CLASS_MODAL_RESOURCE:"modal-resource",CLASS_MODAL_SHORTNAME:"shortname-modal-resource",CLASS_MODAL_TEXT:"text-modal-resource",CLASS_MODAL_TITLE:"title-modal-resource",CLASS_HIDE:"ocult",CLASS_RESOURCE_TITLE:"resource-title"},ATTRIBUTES:{ID:"id",CLASS:"class",HREF:"href",DATA_MCE_HREF:"data-mce-href",DATA_TARGET:"data-target",DATA_PANEL_ID:"data-panel-id",DATA_PANEL_PARENT:"data-panel-parent",SRC:"src"},LANG:{NEW_TAB:"Nova pestanyzepa",NEW_PANEL_INFO:'Nou panell<span class="custom-icon plus">&nbsp;</span>',NEW_RESOURCE:"Nou recurs",NEW_RESOURCE_PANEL:"Nou panell de recursos",NEW_SECTION:"Nova secció",CONTENT_TAB:"<div><p>Contingut de la pestanya</p></div>",DELETE_TAB:"Estàs segur que vols esborrar la pestanya",CONTENT_PANEL:"<div><p>Text del panell</p></div>",DELETE_PANEL:"Estàs segur que vols esborrar el panell",DELETE_SECTION:"Estàs segur que vols esborrar la secció",CONTENT_DATE:"X - X setembre 20XX",RESOURCE_CODE:"MXX"},PATHS:{RESOURCE:"templates/ioc/images/resources/default-resource.jpg"}};e.on("click",function(E){if(t=E.target,S=t.parentElement,(N=t.className.indexOf(l.SELECTORS.CLASS_TAB_TITLE)>-1&&"LI"==S.parentElement.tagName&&S.parentElement.parentElement.className.indexOf(l.SELECTORS.CLASS_TAB_NODE)>-1)&&(e.fire("EditCustomAnchors",{node:S}),(T=document.getElementsByClassName(l.SELECTORS.CLASS_INSERT_LINK)[0]).parentElement.click()),"A"==t.tagName&&t.parentElement.className.indexOf(l.SELECTORS.CLASS_PANEL_TITLE)>-1&&(e.fire("EditCustomAnchors",{node:t}),(T=document.getElementsByClassName(l.SELECTORS.CLASS_INSERT_LINK)[0]).parentElement.click()),t.className.indexOf(l.SELECTORS.CLASS_STUDY_BUTTON)>-1&&"A"==t.parentElement.tagName&&(e.fire("EditCustomAnchors",{node:S}),(T=document.getElementsByClassName(l.SELECTORS.CLASS_INSERT_LINK)[0]).parentElement.click()),t.tagName==l.TAGS.UL||t.tagName==l.TAGS.LI){if(t.tagName==l.TAGS.UL&&t.className.indexOf(l.SELECTORS.CLASS_TAB_NODE)>-1)return t.getElementsByTagName(l.TAGS.LI).length<4&&(T=t.firstChild.cloneNode(!0),a=T.getElementsByTagName(l.TAGS.A)[0],L=a.getElementsByClassName(l.SELECTORS.CLASS_TAB_TITLE)[0],n=Math.random().toString(36).substring(2,15),T.removeAttribute(l.ATTRIBUTES.CLASS),a.setAttribute(l.ATTRIBUTES.HREF,"#"+n),a.setAttribute(l.ATTRIBUTES.DATA_MCE_HREF,"#"+n),L.innerHTML=l.LANG.NEW_TAB,t.appendChild(T),L=e.getBody(),T=L.getElementsByClassName(l.SELECTORS.CLASS_TAB_CONTENT)[0],(L=T.firstChild.cloneNode(!0)).setAttribute(l.ATTRIBUTES.ID,n),L.className=l.SELECTORS.CLASS_TAB_PANE,L.innerHTML=l.LANG.CONTENT_TAB,T.appendChild(L)),!1;if(t.tagName==l.TAGS.LI&&t.parentElement.className.indexOf(l.SELECTORS.CLASS_TAB_NODE)>-1)return L=t.getElementsByTagName(l.TAGS.A)[0],confirm(l.LANG.DELETE_TAB+" '"+L.textContent+"'?")&&(_=L.getAttribute(l.ATTRIBUTES.DATA_MCE_HREF).slice(1),T=e.dom.get(_),t.parentElement.removeChild(t),T.parentElement.removeChild(T)),!1}else{if(t.getAttribute("id")==l.SELECTORS.ID_MORE_INFO)return T=t.firstChild.cloneNode(!0),L=T.getElementsByClassName(l.SELECTORS.CLASS_TITLE_MORE_INFO)[0],n=Math.random().toString(36).substring(2,15),L.setAttribute(l.ATTRIBUTES.HREF,"#"+n),L.setAttribute(l.ATTRIBUTES.DATA_MCE_HREF,"#"+n),L.innerHTML=l.LANG.NEW_PANEL_INFO,(L=T.getElementsByClassName(l.SELECTORS.CLASS_PANEL_CONTENT)[0]).setAttribute(l.ATTRIBUTES.ID,n),L=L.firstChild,L.innerHTML=l.LANG.CONTENT_PANEL,t.appendChild(T),!1;if(t.parentElement.getAttribute("id")==l.SELECTORS.ID_MORE_INFO&&t.className.indexOf(l.SELECTORS.CLASS_PANEL_NODE)>-1)return L=t.getElementsByClassName(l.SELECTORS.CLASS_TITLE_MORE_INFO)[0],confirm(l.LANG.DELETE_PANEL+" '"+L.textContent+"'?")&&t.parentElement.removeChild(t),!1;if(t.tagName==l.TAGS.DIV&&t.className.indexOf(l.SELECTORS.CLASS_STUDY_BLOCK)>-1)return L=t.firstChild,confirm(l.LANG.DELETE_SECTION+" '"+L.textContent+"'?")&&t.parentElement.removeChild(t),!1;if(t.tagName==l.TAGS.DIV&&t.className.indexOf(l.SELECTORS.CLASS_STUDY_DATES)>-1)return t.getElementsByClassName(l.SELECTORS.CLASS_STUDY_BLOCK).length<4&&(T=t.getElementsByClassName(l.SELECTORS.CLASS_STUDY_BLOCK)[0].cloneNode(!0),(L=T.getElementsByClassName(l.SELECTORS.CLASS_SEMIHEADER)[0]).innerHTML=l.LANG.NEW_SECTION,(L=T.getElementsByClassName(l.SELECTORS.CLASS_STUDY_DATE)[0]).innerHTML=l.LANG.CONTENT_DATE,t.appendChild(T)),!1;if(t.tagName==l.TAGS.P&&S.className.indexOf(l.SELECTORS.CLASS_MODAL_CONTENT)>-1)return S.childNodes[1]!=t||(t.className!=l.SELECTORS.CLASS_HIDE&&(t.innerHTML="&nbsp;"),t.classList.toggle(l.SELECTORS.CLASS_HIDE),!1);if(t.tagName==l.TAGS.DIV&&t.className==l.SELECTORS.CLASS_PANEL_BODY)return T=t.firstChild.cloneNode(!0),L=T.getElementsByClassName(l.SELECTORS.CLASS_MODAL_BOTTOM)[0],L.innerHTML=l.LANG.RESOURCE_CODE,n=Math.random().toString(36).substring(2,15),T.setAttribute(l.ATTRIBUTES.DATA_TARGET,"#"+n),L=T.getElementsByClassName(l.SELECTORS.CLASS_MODAL_TEXT)[0],L.innerHTML=l.LANG.NEW_RESOURCE,(L=T.getElementsByTagName(l.TAGS.IMG)[0]).setAttribute(l.ATTRIBUTES.SRC,l.PATHS.RESOURCE),t.appendChild(T),L=e.getBody(),_=S.parentElement.getAttribute(l.ATTRIBUTES.DATA_PANEL_ID),T=L.querySelectorAll("["+l.ATTRIBUTES.DATA_PANEL_PARENT+"='"+_+"']")[0],(L=T.firstChild.cloneNode(!0)).setAttribute(l.ATTRIBUTES.ID,n),(C=L.getElementsByTagName(l.TAGS.IMG)[0]).setAttribute(l.ATTRIBUTES.SRC,l.PATHS.RESOURCE),C=L.getElementsByClassName(l.SELECTORS.CLASS_MODAL_SHORTNAME)[0],C.innerHTML=l.LANG.RESOURCE_CODE,C=L.getElementsByClassName(l.SELECTORS.CLASS_MODAL_TITLE)[0],C.innerHTML=l.LANG.NEW_RESOURCE,T.appendChild(L),!1;if(t.tagName==l.TAGS.DIV&&t.className==l.SELECTORS.CLASS_MODAL_RESOURCE)return L=t.getElementsByClassName(l.SELECTORS.CLASS_MODAL_TEXT)[0],confirm(l.LANG.DELETE_TAB+" '"+L.textContent+"'?")&&(_=L.parentNode.getAttribute(l.ATTRIBUTES.DATA_TARGET).slice(1),t.parentElement.removeChild(t),(T=e.dom.get(_)).parentElement.removeChild(T)),!1;if(t.tagName==l.TAGS.DIV&&t.className.indexOf(l.SELECTORS.CLASS_PANEL_RESOURCES)>-1){T=t.firstChild.cloneNode(!0);for(r=(A=T.getElementsByClassName(l.SELECTORS.CLASS_MODAL_RESOURCE)).length-1;r>0;r--)A.item(r).parentElement.removeChild(A.item(r));n=Math.random().toString(36).substring(2,15),T.setAttribute(l.ATTRIBUTES.DATA_PANEL_ID,n),(L=T.getElementsByClassName(l.SELECTORS.CLASS_MODAL_BOTTOM)[0]).innerHTML=l.LANG.RESOURCE_CODE,s=Math.random().toString(36).substring(2,15),(a=T.getElementsByTagName(l.TAGS.A)[0]).setAttribute(l.ATTRIBUTES.HREF,"#"+s),a.setAttribute(l.ATTRIBUTES.DATA_MCE_HREF,"#"+s),(L=a.getElementsByClassName(l.SELECTORS.CLASS_RESOURCE_TITLE)[0]).innerHTML=l.LANG.NEW_RESOURCE_PANEL,(L=T.getElementsByClassName(l.SELECTORS.CLASS_PANEL_CONTENT)[0]).setAttribute(l.ATTRIBUTES.ID,s),s=Math.random().toString(36).substring(2,15),(C=L.getElementsByClassName(l.SELECTORS.CLASS_MODAL_RESOURCE)[0]).setAttribute(l.ATTRIBUTES.DATA_TARGET,"#"+s),(L=T.getElementsByClassName(l.SELECTORS.CLASS_MODAL_TEXT)[0]).innerHTML=l.LANG.NEW_RESOURCE,(L=T.getElementsByTagName(l.TAGS.IMG)[0]).setAttribute(l.ATTRIBUTES.SRC,l.PATHS.RESOURCE),t.appendChild(T),L=e.getBody(),T=L.getElementsByClassName(l.SELECTORS.CLASS_MODAL_BODY)[0],L=T.cloneNode(!0);for(var r=(A=L.getElementsByClassName(l.SELECTORS.CLASS_MODAL)).length-1;r>0;r--)A.item(r).parentElement.removeChild(A.item(r));return L.setAttribute(l.ATTRIBUTES.DATA_PANEL_PARENT,n),L.firstChild.setAttribute(l.ATTRIBUTES.ID,s),(C=L.getElementsByTagName(l.TAGS.IMG)[0]).setAttribute(l.ATTRIBUTES.SRC,l.PATHS.RESOURCE),C=L.getElementsByClassName(l.SELECTORS.CLASS_MODAL_SHORTNAME)[0],C.innerHTML=l.LANG.RESOURCE_CODE,C=L.getElementsByClassName(l.SELECTORS.CLASS_MODAL_TITLE)[0],C.innerHTML=l.LANG.NEW_RESOURCE,t.appendChild(L),!1}if(t.tagName==l.TAGS.DIV&&t.className==l.SELECTORS.CLASS_PANEL_HEADING&&S.hasAttribute(l.ATTRIBUTES.DATA_PANEL_ID))return L=t.getElementsByClassName(l.SELECTORS.CLASS_RESOURCE_TITLE)[0],confirm(l.LANG.DELETE_TAB+" '"+L.textContent+"'?")&&(_=S.getAttribute(l.ATTRIBUTES.DATA_PANEL_ID),(L=S.parentElement).removeChild(S),(T=L.querySelectorAll("["+l.ATTRIBUTES.DATA_PANEL_PARENT+"='"+_+"']")[0]).parentElement.removeChild(T)),!1}})});